<div class="historial-altas-section">
  <h2>Historial de Altas</h2>

  <!-- Filtro -->
  <div class="filter-container">
    <input type="text" placeholder="Filtrar..." [(ngModel)]="filtro" (ngModelChange)="aplicarFiltro($event)">
  </div>

  <div class="table-container">
    <table class="table">
      <thead>
        <tr>
          <th (click)="ordenar('idHistorial')">ID Historial <span *ngIf="columnaOrdenada === 'idHistorial'">{{ orden === 'asc' ? '▲' : '▼' }}</span></th>
          <th (click)="ordenar('idPaciente')">ID Paciente <span *ngIf="columnaOrdenada === 'idPaciente'">{{ orden === 'asc' ? '▲' : '▼' }}</span></th>
          <th (click)="ordenar('fechaAlta')">Fecha de Alta <span *ngIf="columnaOrdenada === 'fechaAlta'">{{ orden === 'asc' ? '▲' : '▼' }}</span></th>
          <th (click)="ordenar('diagnostico')">Diagnóstico <span *ngIf="columnaOrdenada === 'diagnostico'">{{ orden === 'asc' ? '▲' : '▼' }}</span></th>
          <th (click)="ordenar('tratamiento')">Tratamiento <span *ngIf="columnaOrdenada === 'tratamiento'">{{ orden === 'asc' ? '▲' : '▼' }}</span></th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let historial of historialAltasPaginadas">
          <td>{{ historial.idHistorial }}</td>
          <td>{{ historial.idPaciente }}</td>
          <td>{{ historial.fechaAlta | date }}</td>
          <td>{{ historial.diagnostico }}</td>
          <td>{{ historial.tratamiento }}</td>
          <td>
            <button (click)="toggleActualizarHistorialAlta(historial)">Actualizar</button>
            <button (click)="borrarHistorialAlta(historial.idHistorial)">Borrar</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Barra de paginación -->
  <div class="pagination">
    <button (click)="paginaAnterior()" [disabled]="paginaActual === 1">Anterior</button>
    <span>Página {{paginaActual}} de {{totalPaginas}}</span>
    <button (click)="paginaSiguiente()" [disabled]="paginaActual === totalPaginas">Siguiente</button>
  </div>

  <!-- Formulario para agregar y actualizar -->
  <div class="form-container" *ngIf="historialAltaParaActualizar">
    <h3>Actualizar Historial de Alta</h3>
    <form (ngSubmit)="actualizarHistorialAlta()">
      <label for="idHistorial">ID Historial:</label>
      <input type="number" id="idHistorial" [(ngModel)]="historialAltaParaActualizar.idHistorial" name="idHistorial" disabled>
      <label for="idPaciente">ID Paciente:</label>
      <input type="number" id="idPaciente" [(ngModel)]="historialAltaParaActualizar.idPaciente" name="idPaciente">
      <label for="fechaAlta">Fecha de Alta:</label>
      <input type="date" id="fechaAlta" [(ngModel)]="historialAltaParaActualizar.fechaAlta" name="fechaAlta">
      <label for="diagnostico">Diagnóstico:</label>
      <input type="text" id="diagnostico" [(ngModel)]="historialAltaParaActualizar.diagnostico" name="diagnostico">
      <label for="tratamiento">Tratamiento:</label>
      <input type="text" id="tratamiento" [(ngModel)]="historialAltaParaActualizar.tratamiento" name="tratamiento">
      <button type="submit">Guardar</button>
    </form>
  </div>

  <div class="form-container">
    <h3>Agregar Historial de Alta</h3>
    <form (ngSubmit)="agregarHistorialAlta()">
      <label for="idPaciente">ID Paciente:</label>
      <input type="number" id="idPaciente" [(ngModel)]="nuevoHistorialAlta.idPaciente" name="idPaciente">
      <label for="fechaAlta">Fecha de Alta:</label>
      <input type="date" id="fechaAlta" [(ngModel)]="nuevoHistorialAlta.fechaAlta" name="fechaAlta">
      <label for="diagnostico">Diagnóstico:</label>
      <input type="text" id="diagnostico" [(ngModel)]="nuevoHistorialAlta.diagnostico" name="diagnostico">
      <label for="tratamiento">Tratamiento:</label>
      <input type="text" id="tratamiento" [(ngModel)]="nuevoHistorialAlta.tratamiento" name="tratamiento">
      <button type="submit">Agregar</button>
    </form>
  </div>
</div>
